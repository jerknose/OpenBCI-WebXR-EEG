webpackJsonp([0],{296:function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var r=n(1),i=_interopRequireDefault(r),o=n(21),s=_interopRequireDefault(o),a=n(458),l=n(299),u=_interopRequireDefault(l),c=function(e){s["default"].render(i["default"].createElement(a.AppContainer,null,i["default"].createElement(e,null)),document.getElementById("kv-root"))};c(u["default"]);!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(c,"render","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/index.jsx")}()},297:function(e,t,n){"use strict";(function(t){var n={dataPlayback:{enabled:!0,freqFile:"./../../data/fftcenter.csv",intenseFile:"./../../data/fftpower.csv",playbackRate:10,autoplay:!0,loop:!0,ports:{outgoing:9999}},openbci:{cyton:{enabled:!1,debug:!1,verbose:!0},ganglion:{enabled:!1,debug:!1,verbose:!0,impedance:!1,accel:!1}},server:{port:9e3},app:{port:8080},favicon:t+"./../dist/images/favicon.ico",copy:{html:{src:"./src/html/index.html",dest:"./dist/index.html"},fonts:{src:"./src/fonts",dest:"./dist/fonts"},images:{src:"./src/images",dest:"./dist/images"},models:{src:"./src/models",dest:"./dist/models"},textures:{src:"./src/textures",dest:"./dist/textures"}}};e.exports=n;!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(n,"config","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/server/config.js")}()}).call(t,"/")},298:function(e,t,n){"use strict";var r=n(297),i=function(e){return e&&e.__esModule?e:{default:e}}(r),o={debug:!0,dataPlayback:{ports:{outgoing:i["default"].dataPlayback.ports.outgoing}}};e.exports=o;!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(o,"defaults","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/config/index.js")}()},299:function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),i=n(1),o=_interopRequireDefault(i);n(454);n(769);var s=n(770),a=(_interopRequireDefault(s),n(303)),l=_interopRequireDefault(a),u=function(e){function Main(e){_classCallCheck(this,Main);var t=_possibleConstructorReturn(this,(Main.__proto__||Object.getPrototypeOf(Main)).call(this,e));return t.state={},t}return _inherits(Main,e),r(Main,[{key:"componentWillMount",value:function(){this.setState({scene:new l["default"]})}},{key:"componentDidMount",value:function(){this.state.scene.initScene()}},{key:"render",value:function(){return o["default"].createElement("div",{className:"app"},o["default"].createElement("div",{id:"threeContainer"}),o["default"].createElement("div",{id:"statsBox"}))}}]),Main}(o["default"].Component),c=u;t["default"]=c;!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(u,"Main","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/pages/Main.jsx"),__REACT_HOT_LOADER__.register(c,"default","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/pages/Main.jsx"))}()},300:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[{label:"FPz",theta:0,radius:.507,x:85,y:0,z:-1.79,sph_theta:0,sph_phi:-1.2,sph_radius:85,type:"EEG"},{label:"EOG1",type:"EOG"},{label:"F3",theta:-39.9,radius:.345,x:57.6,y:48.2,z:39.9,sph_theta:39.9,sph_phi:28,sph_radius:85,type:"EEG"},{label:"Fz",theta:0,radius:.253,x:60.7,y:0,z:59.5,sph_theta:0,sph_phi:44.4,sph_radius:85,type:"EEG"},{label:"F4",theta:39.9,radius:.344,x:57.6,y:-48.1,z:39.9,sph_theta:-39.9,sph_phi:28,sph_radius:85,type:"EEG"},{label:"EOG2",type:"EOG"},{label:"FC5",theta:-69.3,radius:.408,x:28.8,y:76.2,z:24.2,sph_theta:69.3,sph_phi:16.5,sph_radius:85,type:"EEG"},{label:"FC1",theta:-44.9,radius:.181,x:32.4,y:32.4,z:71.6,sph_theta:44.9,sph_phi:57.4,sph_radius:85,type:"EEG"},{label:"FC2",theta:44.9,radius:.181,x:32.4,y:-32.4,z:71.6,sph_theta:-44.9,sph_phi:57.4,sph_radius:85,type:"EEG"},{label:"FC6",theta:69.3,radius:.408,x:28.8,y:-76.2,z:24.2,sph_theta:-69.3,sph_phi:16.5,sph_radius:85,type:"EEG"},{label:"T7",theta:-90,radius:.533,x:0,y:84.5,z:-8.85,sph_theta:90,sph_phi:-5.97,sph_radius:85,type:"EEG"},{label:"C3",theta:-90,radius:.267,x:0,y:63.2,z:56.9,sph_theta:90,sph_phi:42,sph_radius:85,type:"EEG"},{label:"C4",theta:90,radius:.267,x:0,y:-63.2,z:56.9,sph_theta:-90,sph_phi:42,sph_radius:85,type:"EEG"},{label:"Cz",theta:0,radius:0,x:0,y:0,z:85,sph_theta:0,sph_phi:90,sph_radius:85,type:"EEG"},{label:"T8",theta:90,radius:.533,x:0,y:-84.5,z:-8.85,sph_theta:-90,sph_phi:-5.97,sph_radius:85,type:"EEG"},{label:"CP5",theta:-111,radius:.408,x:-28.8,y:76.2,z:24.2,sph_theta:111,sph_phi:16.5,sph_radius:85,type:"EEG"},{label:"CP1",theta:-135,radius:.181,x:-32.4,y:32.4,z:71.6,sph_theta:135,sph_phi:57.4,sph_radius:85,type:"EEG"},{label:"CP2",theta:135,radius:.181,x:-32.4,y:-32.4,z:71.6,sph_theta:-135,sph_phi:57.4,sph_radius:85,type:"EEG"},{label:"CP6",theta:111,radius:.408,x:-28.8,y:-76.2,z:24.2,sph_theta:-111,sph_phi:16.5,sph_radius:85,type:"EEG"},{label:"P7",theta:-126,radius:.528,x:-49.9,y:68.4,z:-7.49,sph_theta:126,sph_phi:-5.06,sph_radius:85,type:"EEG"},{label:"P3",theta:-140,radius:.345,x:-57.6,y:48.2,z:39.9,sph_theta:140,sph_phi:28,sph_radius:85,type:"EEG"},{label:"Pz",theta:180,radius:.253,x:-60.7,y:0,z:59.5,sph_theta:-180,sph_phi:44.4,sph_radius:85,type:"EEG"},{label:"P4",theta:140,radius:.344,x:-57.6,y:-48.1,z:39.9,sph_theta:-140,sph_phi:28,sph_radius:85,type:"EEG"},{label:"P8",theta:126,radius:.528,x:-49.9,y:-68.4,z:-7.49,sph_theta:-126,sph_phi:-5.05,sph_radius:85,type:"EEG"},{label:"PO7",theta:-144,radius:.522,x:-68.7,y:49.7,z:-5.96,sph_theta:144,sph_phi:-4.02,sph_radius:85,type:"EEG"},{label:"PO3",theta:-158,radius:.421,x:-76.2,y:31.5,z:20.8,sph_theta:158,sph_phi:14.2,sph_radius:85,type:"EEG"},{label:"POz",theta:180,radius:.38,x:-79,y:0,z:31.3,sph_theta:-180,sph_phi:21.6,sph_radius:85,type:"EEG"},{label:"PO4",theta:158,radius:.421,x:-76.2,y:-31.5,z:20.8,sph_theta:-158,sph_phi:14.2,sph_radius:85,type:"EEG"},{label:"PO8",theta:144,radius:.522,x:-68.7,y:-49.7,z:-5.95,sph_theta:-144,sph_phi:-4.02,sph_radius:85,type:"EEG"},{label:"O1",theta:-162,radius:.515,x:-80.8,y:26.1,z:-4,sph_theta:162,sph_phi:-2.7,sph_radius:85,type:"EEG"},{label:"Oz",theta:180,radius:.507,x:-85,y:0,z:-1.79,sph_theta:-180,sph_phi:-1.2,sph_radius:85,type:"EEG"},{label:"O2",theta:162,radius:.515,x:-80.8,y:-26.1,z:-4,sph_theta:-162,sph_phi:-2.7,sph_radius:85,type:"EEG"}],i=r;t["default"]=i;!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(r,"device01","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/three/devices/device01.js"),__REACT_HOT_LOADER__.register(i,"default","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/three/devices/device01.js"))}()},301:function(e,t,n){"use strict";(function(e,r){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),o=n(300),s=function(e){return e&&e.__esModule?e:{default:e}}(o),a=function(){function EEGPointcloud(t){_classCallCheck(this,EEGPointcloud),this.dotScale=5,this.subScene=t;for(var r=new e.TextureLoader,i=new e.BufferGeometry,o=s["default"].length,a=new e.Color,l=new e.Vector3,u=new Float32Array(3*o),c=new Float32Array(3*o),d=new Float32Array(o),h=0;h<o;h++)l.x=s["default"][h].x,l.y=s["default"][h].y,l.z=s["default"][h].z,l.toArray(u,3*h),a.setHSL(1,1,1),a.toArray(c,3*h),d[h]=.1;i.addAttribute("position",new e.BufferAttribute(u,3)),i.addAttribute("customColor",new e.BufferAttribute(c,3)),i.addAttribute("size",new e.BufferAttribute(d,1));var p=new e.ShaderMaterial({transparent:!0,depthTest:!1,uniforms:{color:{value:new e.Color(16777215)},texture:{value:r.load("textures/sprites/disc.png")}},vertexShader:n(783),fragmentShader:n(782)});this.points=new e.Points(i,p)}return i(EEGPointcloud,[{key:"updateData",value:function(t){var n=this;r.each(t,function(t,r){var i=s["default"].findIndex(function(e){return e.label===r}),o=parseFloat(t.freq);new e.Color(n.mapRange(o,9,15,0,1),n.mapRange(Math.abs(o-12),3,0,0,1),n.mapRange(o,15,9,0,1)).toArray(n.points.geometry.attributes.customColor.array,3*i),n.points.geometry.attributes.customColor.needsUpdate=!0,n.points.geometry.attributes.size.array[i]=n.mapRange(parseFloat(t["int"]),10,70,.1,n.dotScale)*(n.subScene.scale.x/10)+.01,n.points.geometry.attributes.size.needsUpdate=!0,n.points.geometry.needsUpdate=!0})}},{key:"mapRange",value:function(e,t,n,r,i){var o=n-t,s=i-r,a=(e-t)/o*s+r;return a=a>i?i:a,a=a<r?r:a}}]),EEGPointcloud}(),l=a;t["default"]=l;!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(a,"EEGPointcloud","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/three/eegPointcloud.js"),__REACT_HOT_LOADER__.register(l,"default","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/three/eegPointcloud.js"))}()}).call(t,n(25),n(162))},302:function(e,t,n){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),i=function(){function PlaybackStream(e,t){_classCallCheck(this,PlaybackStream),this.callback=t,this.websocket=null,this.initializeWebSocket(e)}return r(PlaybackStream,[{key:"initializeWebSocket",value:function(e){var t=this;console.log("Playback Stream connecting to: ",e),this.websocket=new WebSocket(e),this.websocket.onopen=this.onOpen.bind(this),this.websocket.onclose=this.onClose.bind(this),this.websocket.onmessage=this.onMessage.bind(this),this.websocket.onerror=this.onError.bind(this),window.addEventListener("beforeunload",function(){t.websocket.close()})}},{key:"onOpen",value:function(e){console.log("Playback Stream connected:",e)}},{key:"onClose",value:function(e){console.log("Playback Stream  disconnected:",e)}},{key:"onMessage",value:function(e){this.callback(JSON.parse(e.data))}},{key:"onError",value:function(e){console.log("Playback Stream  error:",e)}}]),PlaybackStream}();e.exports=i;!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(i,"PlaybackStream","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/three/inputs/playbackStream.js")}()},303:function(e,t,n){"use strict";(function(e,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),o=n(778),s=_interopRequireDefault(o),a=n(298),l=_interopRequireDefault(a),u=n(301),c=_interopRequireDefault(u),d=n(302),h=_interopRequireDefault(d),p=n(305),f=_interopRequireDefault(p),m=n(306),g=_interopRequireDefault(m);n(294),n(775),n(772);var v=n(774),_=function(){function Scene(){_classCallCheck(this,Scene),this.renderer=null,this.scene=null,this.camera=null,this.controls=null,this.container=null,this.w=null,this.h=null,this.stats=null,this.brain,this.skull}return i(Scene,[{key:"initScene",value:function(){var t=this;this.container=e("#threeContainer"),this.w=this.container.width(),this.h=this.container.height(),this.renderer=new r.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.sortObjects=!1,this.renderer.setClearColor(0),this.renderer.setSize(this.w,this.h),this.scene=new r.Scene,window.scene=this.scene,this.addLights(),l["default"].debug&&this.scene.add(new r.AxisHelper(5)),this.camera=new r.PerspectiveCamera(20,this.w/this.h,.001,1e6),window.camera=this.camera,this.camera.position.set(0,0,2),this.scene.add(this.camera),this.controls=new r.TrackballControls(this.camera),this.controls.target=new r.Vector3(0,0,0),window.controls=this.controls,this.configControls(),this.container.append(this.renderer.domElement),this.clock=new r.Clock,this.vr=new f["default"](this.renderer,this.camera,this.scene,this.controls),this.vr.on("isPresenting",this.isVRPresenting.bind(this)),this.head=this.loadHead(),window.head=this.head,this.scene.add(this.head),this.eeg_pc=new c["default"](this.head),window.eeg_pc=this.eeg_pc.points,this.eeg_pc.points.scale.set(.0021,.0021,.0021),this.eeg_pc.points.rotation.x=-Math.PI/2-Math.PI/18,this.eeg_pc.points.rotation.z=-Math.PI/2,this.eeg_pc.points.position.y=-.02,this.head.add(this.eeg_pc.points),new h["default"]("ws://"+window.location.hostname+":"+l["default"].dataPlayback.ports.outgoing,function(e){t.eeg_pc.updateData(e)}),this.vrPoseControl=new g["default"](this.head,this.vr),this.vr&&(this.vrPoseControl.startPoseControl(),this.vr.buttonAStream.distinctUntilChanged().filter(function(e){return e}).subscribe(function(e){t.toggleWireframe(t.brain)}),this.vr.buttonBStream.distinctUntilChanged().filter(function(e){return e}).subscribe(function(e){t.toggleWireframe(t.brain)}),this.vr.buttonXStream.distinctUntilChanged().filter(function(e){return e}).subscribe(function(e){t.toggleWireframe(t.skull)}),this.vr.leftStickStream.filter(function(e){return Math.abs(e[1])>.1}).subscribe(function(e){t.changeOpacity(t.brain,-e[1]/1e3)}),this.vr.rightStickStream.filter(function(e){return Math.abs(e[1])>.1}).subscribe(function(e){t.changeOpacity(t.skull,-e[1]/1e3)})),l["default"].debug&&(this.stats=new v,document.body.appendChild(this.stats.dom)),this.addEventListeners(),this.animate()}},{key:"addLights",value:function(){this.scene.add(new r.AmbientLight(16777215));var e=new r.DirectionalLight(16777215,.125);e.position.y=10,e.position.normalize(),this.scene.add(e)}},{key:"toggleWireframe",value:function(e){e.traverse(function(e){e instanceof r.Mesh&&(e.material.wireframe=!e.material.wireframe,e.material.needsUpdate=!0)})}},{key:"changeOpacity",value:function(e,t){e.traverse(function(e){e instanceof r.Mesh&&(e.material.opacity+=t,e.material.needsUpdate=!0,e.material.opacity<.001&&(e.material.opacity=.001),e.material.opacity>1&&(e.material.opacity=1))})}},{key:"configControls",value:function(){this.controls.rotateSpeed=1,this.controls.zoomSpeed=1.2,this.controls.panSpeed=.8,this.controls.noZoom=!1,this.controls.noPan=!1,this.controls.staticMoving=!0,this.controls.dynamicDampingFactor=.3,this.controls.keys=[65,83,16]}},{key:"loadHead",value:function(){var e=this,t=new r.Object3D;return this.loadObj("models/skulls/Skull.obj",{color:16777215,opacity:.01,wireframe:!0,transparent:!0,side:r.BackSide,depthTest:!1},function(n){n.scale.set(88e-5,88e-5,88e-5),n.position.set(-.0129,-.09,-.005),n.rotation.x=Math.PI/25,n.renderOrder=1,e.skull=n,t.add(n)}),this.loadObj("models/brains/spineless.obj",{color:7259643,opacity:.015,wireframe:!0,transparent:!0,depthTest:!1},function(n){n.scale.set(.022,.022,.022),n.position.set(0,0,0),n.renderOrder=100,e.brain=n,t.add(n)}),t}},{key:"isVRPresenting",value:function(e){e.display&&e.display.isPresenting?(this.head.position.set(-.0021,1.6715,-1.7996),this.controls.enabled=!1,this.removeEventListeners(),this.eeg_pc.dotScale=2.5):(this.head.position.set(0,0,0),this.controls.enabled=!0,this.addEventListeners(),this.eeg_pc.dotScale=5)}},{key:"addEventListeners",value:function(){var e=this;this.renderer.domElement.addEventListener("mousemove",function(t){return e.onDocumentMouseMove(t)},!1),this.renderer.domElement.addEventListener("mousedown",function(t){return e.onDocumentMouseDown(t)},!1),this.renderer.domElement.addEventListener("mouseout",function(t){return e.onDocumentMouseUp(t)},!1),document.addEventListener("mouseup",function(t){return e.onDocumentMouseUp(t)},!1),window.addEventListener("resize",function(t){return e.resizeRenderer(t)},!0),this.configControls()}},{key:"removeEventListeners",value:function(){var e=this;this.renderer.domElement.removeEventListener("mousemove",function(t){return e.onDocumentMouseMove(t)},!1),this.renderer.domElement.removeEventListener("mousedown",function(t){return e.onDocumentMouseDown(t)},!1),this.renderer.domElement.removeEventListener("mouseout",function(t){return e.onDocumentMouseUp(t)},!1),document.removeEventListener("mouseup",function(t){return e.onDocumentMouseUp(t)},!1),window.removeEventListener("resize",function(t){return e.resizeRenderer(t)},!0)}},{key:"loadObj",value:function(e,t,n){var i=this;new r.OBJLoader(new r.LoadingManager).load(e,function(e){e.traverse(function(e){e.position.set(0,0,0),e instanceof r.Mesh&&(e.material=i.updateMaterial(t))}),n(e)},function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;console.log(Math.round(t,2)+"% downloaded")}},function(e){console.log("OBJLoader Error: ",e)})}},{key:"loadCollada",value:function(e,t,n){var i=this,o=null;new r.ColladaLoader(new r.LoadingManager(function(){n(o)})).load(e,function(e){o=e.scene,o.traverse(function(e){e.position.set(0,0,0),e instanceof r.Mesh&&(e.material=i.updateMaterial(t))})})}},{key:"updateMaterial",value:function(e){return new r.MeshPhongMaterial({color:e.color||16777215,wireframe:e.wireframe||!1,opacity:e.opacity||.75,transparent:e.transparent||!1,side:r.DoubleSide,depthTest:e.depthTest||!1})}},{key:"animate",value:function(){this.vr&&this.vr.vrEffect?this.vr.vrEffect.requestAnimationFrame(this.animate.bind(this)):requestAnimationFrame(this.animate.bind(this)),this.controls.update(),this.render()}},{key:"render",value:function(){s["default"].update(),l["default"].debug&&this.stats.update(),this.vr&&this.vr.render(this.vr),this.renderer.render(this.scene,this.camera)}},{key:"resizeRenderer",value:function(t){var n=e("#threeContainer").width(),r=e("#threeContainer").height();this.camera.aspect=n/r,this.camera.updateProjectionMatrix(),this.renderer.setSize(n,r)}},{key:"onDocumentMouseMove",value:function(e){}},{key:"onDocumentMouseDown",value:function(e){}},{key:"onDocumentMouseUp",value:function(e){}}]),Scene}(),y=_;t["default"]=y;!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(_,"Scene","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/three/scene.js"),__REACT_HOT_LOADER__.register(y,"default","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/three/scene.js"))}()}).call(t,n(161),n(25))},304:function(e,t,n){"use strict";(function(e){e.RiftController=function(t){function findGamepad(e){for(var t=navigator.getGamepads(),n=0,r=0;n<4;n++){var i=t[n];if(i&&("Oculus Touch (Left)"===i.id||"Oculus Touch (Right)"===i.id)){if(r===e)return i;r++}}}e.Object3D.call(this);var n,r=this,i=[0,0],o=!1,s=!1,a=!1,l=!1;this.matrixAutoUpdate=!1,this.standingMatrix=new e.Matrix4,this.getGamepad=function(){return n},this.getButtonState=function(e){return"thumbpad"===e?o:"trigger"===e?s:"grips"===e?a:"menu"===e?l:void 0},this.update=function(){if((n=findGamepad(t))!==undefined&&n.pose!==undefined){if(null===n.pose)return;var e=n.pose;null!==e.position&&r.position.fromArray(e.position),null!==e.orientation&&r.quaternion.fromArray(e.orientation),r.matrix.compose(r.position,r.quaternion,r.scale),r.matrix.multiplyMatrices(r.standingMatrix,r.matrix),r.matrixWorldNeedsUpdate=!0,r.visible=!0,i[0]===n.axes[0]&&i[1]===n.axes[1]||(i[0]=n.axes[0],i[1]=n.axes[1],r.dispatchEvent({type:"axischanged",axes:i})),o!==n.buttons[0].pressed&&(o=n.buttons[0].pressed,r.dispatchEvent({type:o?"thumbpaddown":"thumbpadup"})),s!==n.buttons[1].pressed&&(s=n.buttons[1].pressed,r.dispatchEvent({type:s?"triggerdown":"triggerup"})),a!==n.buttons[2].pressed&&(a=n.buttons[2].pressed,r.dispatchEvent({type:a?"gripsdown":"gripsup"})),l!==n.buttons[3].pressed&&(l=n.buttons[3].pressed,r.dispatchEvent({type:l?"menudown":"menuup"}))}else r.visible=!1}},e.RiftController.prototype=Object.create(e.Object3D.prototype),e.RiftController.prototype.constructor=e.RiftController}).call(t,n(25))},305:function(e,t,n){"use strict";(function(e,r,i,o){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();n(294),n(776),n(293),n(773),n(293),n(777),n(304);var a=n(375),l=function(){function VR(t,n,r,i){var o=this;_classCallCheck(this,VR),this.renderer=t,this.camera=n,this.parent=r,this.controls=i,this.vrControls=null,this.vrEffect=null,this.gamepadsAttached=0,this.controllers={},this.controllerNames=["right","left","camera"],this.viveControllerModel=null,this.riftLeftControllerModel=null,this.riftRightControllerModel=null,this.raycaster=new e.Raycaster,this.intersected=[],this.tempMatrix=new e.Matrix4,this.group,this.events=[],this.initStreams(),!0===this.isAvailable()&&(this.initEffect(),window.addEventListener("resize",function(e){return o.onWindowResizeevent},!1)),this.gamepadPose={left:{position:{x:0,y:0,z:0},orientation:{x:0,y:0,z:0,w:1}},right:{position:{x:0,y:0,z:0},orientation:{x:0,y:0,z:0,w:1}}}}return s(VR,[{key:"initStreams",value:function(){this.rightControllerPoseStream=new r.Subject,this.rightGripStream=new r.Subject,this.rightTriggerStream=new r.Subject,this.buttonAStream=new r.Subject,this.buttonBStream=new r.Subject,this.rightStickStream=new r.Subject,this.leftControllerPoseStream=new r.Subject,this.leftGripStream=new r.Subject,this.leftTriggerStream=new r.Subject,this.buttonXStream=new r.Subject,this.buttonYStream=new r.Subject,this.leftStickStream=new r.Subject}},{key:"startStreams",value:function(){var e=this;console.log("start controller Rx stream"),this.controllers[0]?(this.controllers[0].addEventListener("gripsdown",function(t){e.rightGripStream.next("down")}),this.controllers[0].addEventListener("gripsup",function(t){e.rightGripStream.next("up")}),this.controllers[0].addEventListener("triggerdown",function(t){e.rightTriggerStream.next("down")}),this.controllers[0].addEventListener("triggerup",function(t){e.rightTriggerStream.next("up")})):console.log("Right Controller is null"),this.controllers[1]?(this.controllers[1].addEventListener("gripsdown",function(t){e.leftGripStream.next("down")}),this.controllers[1].addEventListener("gripsup",function(t){e.leftGripStream.next("up")}),this.controllers[1].addEventListener("triggerdown",function(t){e.leftTriggerStream.next("down")}),this.controllers[1].addEventListener("triggerup",function(t){e.leftTriggerStream.next("up")})):console.log("Left Controller is null")}},{key:"initEffect",value:function(){this.vrEffect=new e.VREffect(this.renderer),this.vrEffect.setSize(i("#threeContainer").width(),i("#threeContainer").height()),window.addEventListener("vrdisplaypresentchange",this.onVRDisplayPresentChange.bind(this)),document.body.appendChild(a.createButton(this.renderer))}},{key:"onVRDisplayPresentChange",value:function(e){var t=this;if(console.log("====VR Display Present Changed====="),e.display.isPresenting){if(console.log("====Entering VR===="),this.trigger("isPresenting",e),this.initVRControls(),navigator){var n=o.filter(navigator.getGamepads(),function(e){return null!==e});o.size(n)>0?this.attachGamePad(n):window.addEventListener("gamepadconnected",function(e){console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",e.gamepad.index,e.gamepad.id,e.gamepad.buttons.length,e.gamepad.axes.length),n=o.filter(navigator.getGamepads(),function(e){return null!==e}),t.attachGamePad(n)})}}else console.log("===Leaving VR==="),this.clearVR(),this.trigger("isPresenting",e.display.isPresenting)}},{key:"attachGamePad",value:function(e){var t=this;if(this.gamepadAttached!==e.length){var n=0;o.each(e,function(e){if(e)switch(console.log("Current gamapad is:",e.id),e.id.slice(0,14)){case"OpenVR Gamepad":t.initViveController(e.id,n),n++;break;case"Oculus Touch (":t.initRiftController(e.id,n),n++}}),this.gamepadAttached++,this.startStreams()}}},{key:"clearVR",value:function(){this.vrEffect.cancelAnimationFrame(),this.vrControls.dispose(),this.vrControls=null,o.each(this.controllers,function(e){null}),this.controllers={}}},{key:"initVRControls",value:function(){this.vrControls=new e.VRControls(this.camera),this.vrControls.standing=!0}},{key:"initViveController",value:function(t,n){var r=this;this.controllers[n]=new e.ViveController(n),this.controllers[n].name=this.controllerNames[n],this.controllers[n].standingMatrix=this.vrControls.getStandingMatrix(),this.controllers[n].addEventListener("axischanged",function(e){r.trigger("axischanged",e)}),this.controllers[n].addEventListener("thumbpaddown",function(e){r.trigger("thumbpaddown",e)}),this.controllers[n].addEventListener("thumbpadup",function(e){r.trigger("thumbpadup",e)}),this.controllers[n].addEventListener("triggerdown",function(e){r.trigger("triggerdown",e)}),this.controllers[n].addEventListener("triggerup",function(e){r.trigger("triggerup",e)}),this.controllers[n].addEventListener("gripsdown",function(e){r.trigger("gripsdown",e)}),this.controllers[n].addEventListener("gripsup",function(e){r.trigger("gripsup",e)}),this.controllers[n].addEventListener("menudown",function(e){r.trigger("menudown",e)}),this.controllers[n].addEventListener("menuup",function(e){r.trigger("menuup",e)}),this.parent.add(this.controllers[n]),this.getViveControllerModel(function(e){console.log("Vive Controller Model :",e),r.controllers[n].add(e.clone())})}},{key:"initRiftController",value:function(t,n){var r=this;this.controllers[n]=new e.RiftController(n),this.controllers[n].name=this.controllerNames[n],this.controllers[n].standingMatrix=this.vrControls.getStandingMatrix(),this.controllers[n].addEventListener("axischanged",function(e){r.trigger("axischanged",e)}),this.controllers[n].addEventListener("thumbpaddown",function(e){r.trigger("thumbpaddown",e)}),this.controllers[n].addEventListener("thumbpadup",function(e){r.trigger("thumbpadup",e)}),this.controllers[n].addEventListener("triggerdown",function(e){r.trigger("triggerdown",e)}),this.controllers[n].addEventListener("triggerup",function(e){r.trigger("triggerup",e)}),this.controllers[n].addEventListener("gripsdown",function(e){r.trigger("gripsdown",e)}),this.controllers[n].addEventListener("gripsup",function(e){r.trigger("gripsup",e)}),this.controllers[n].addEventListener("menudown",function(e){r.trigger("menudown",e)}),this.controllers[n].addEventListener("menuup",function(e){r.trigger("menuup",e)}),this.parent.add(this.controllers[n]);var i="right";-1!==t.toLowerCase().search("left")&&(i="left"),-1!==t.toLowerCase().search("right")&&(i="right"),this.getRiftControllerModel(i,function(e,t){console.log("Rift Controller Model :",e),e.rotation.x=Math.PI/4,e.position.y+=.075,e.position.x+="left"===t?-.0125:.0125,r.controllers[n].add(e.clone())})}},{key:"attachMenu",value:function(e){e.name}},{key:"onWindowResize",value:function(){this.vrEffect.setSize(i("#threeContainer").width(),i("#threeContainer").height())}},{key:"getViveControllerModel",value:function(t){var n=this;if(this.viveControllerModel)t(this.viveControllerModel);else{var r=new e.OBJLoader;r.setPath("/models/viveController/"),r.load("vr_controller_vive_1_5.obj",function(r){(new e.TextureLoader).setPath("/models/viveController/");var i=r.children[0];i.material=new e.MeshBasicMaterial({color:16777215,wireframe:!0,transparent:!0,opacity:.5}),i.castShadow=!0,n.viveControllerModel=r,t(n.viveControllerModel)})}}},{key:"getRiftControllerModel",value:function(t,n){var r=this,i=new e.MeshBasicMaterial({color:"brown",wireframe:!0,transparent:!0,opacity:.25});switch(t){case"left":if(this.riftLeftControllerModel)n(this.riftLeftControllerModel);else{var o=new e.MTLLoader;o.setPath("/models/riftController/"),o.load("oculus-touch-controller-left.mtl",function(o){o.preload();var s=new e.OBJLoader;s.setPath("/models/riftController/"),s.load("oculus-touch-controller-left.obj",function(o){o.children[0].castShadow=!1,r.riftLeftControllerModel=o,o.traverse(function(t){t instanceof e.Mesh&&(t.material=i)}),n(r.riftLeftControllerModel,t)})})}break;case"right":if(this.riftRightControllerModel)n(this.riftRightControllerModel,t);else{var o=new e.MTLLoader;o.setPath("/models/riftController/"),o.load("oculus-touch-controller-right.mtl",function(t){t.preload();var o=new e.OBJLoader;o.setPath("/models/riftController/"),o.load("oculus-touch-controller-right.obj",function(t){t.children[0].castShadow=!1,r.riftRightControllerModel=t,t.traverse(function(t){t instanceof e.Mesh&&(t.material=i)}),n(r.riftRightControllerModel)})})}}}},{key:"isEqualArray",value:function(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:.01;if(e==t)return!0;if(e&&t&&e.length>=0&&t.length>=0&&e.length==t.length){return 0==e.map(function(e,r){return Math.abs(e-t[r])<n}).filter(function(e){return!e}).length}return!1}},{key:"updateGamepadPose",value:function(e,t){!e||this.isEqualArray(this.gamepadPose.left.position,e.position)&&this.isEqualArray(this.gamepadPose.left.orientation,e.orientation)||(this.gamepadPose.left.position=e.position,this.gamepadPose.left.orientation=e.orientation),!t||this.isEqualArray(this.gamepadPose.right.position,t.position)&&this.isEqualArray(this.gamepadPose.right.orientation,t.orientation)||(this.gamepadPose.right.position=t.position,this.gamepadPose.right.orientation=t.orientation)}},{key:"render",value:function(e){o.size(e.controllers)>0&&o.each(e.controllers,function(t){t.update();var n=null;e.controllers[0]&&(n=e.controllers[0].getGamepad())&&(e.rightControllerPoseStream.next(n.pose),e.buttonXStream.next(n.buttons[3].pressed),e.buttonYStream.next(n.buttons[4].pressed),e.rightStickStream.next(n.axes),e.updateGamepadPose(null,n.pose)),e.controllers[1]&&(n=e.controllers[1].getGamepad())&&(e.leftControllerPoseStream.next(n.pose),e.buttonAStream.next(n.buttons[3].pressed),e.buttonBStream.next(n.buttons[4].pressed),e.leftStickStream.next(n.axes),e.updateGamepadPose(n.pose,null))}),e.vrControls&&e.vrControls.update(),e.vrEffect&&e.vrEffect.render(e.parent,e.camera)}},{key:"on",value:function(e,t){this.events[e]=t}},{key:"trigger",value:function(e,t){this.events[e]&&this.events[e](t)}},{key:"isAvailable",value:function(){return navigator.getVRDisplays!==undefined}}]),VR}(),u=l;t["default"]=u;!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(l,"VR","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/three/vr/vr.js"),__REACT_HOT_LOADER__.register(u,"default","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/three/vr/vr.js"))}()}).call(t,n(25),n(192),n(161),n(162))},306:function(e,t,n){"use strict";(function(e,n){function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),i=function(){function VRPoseControl(e,t){_classCallCheck(this,VRPoseControl),this.scene=e,this.vr=t}return r(VRPoseControl,[{key:"startPoseControl",value:function(){var t=this,r=this.vr.leftGripStream,i=this.vr.rightGripStream,o=this.vr.leftControllerPoseStream,s=this.vr.rightControllerPoseStream,a=e.Observable.combineLatest(r,i).debounce(function(t){return e.Observable.interval(0)}).map(function(e){return e[0]===e[1]&&"down"===e[1]});a.filter(function(e){return e}).flatMap(function(r){var i=t.vr.controllers[0].getGamepad().pose.position,l=t.vr.controllers[1].getGamepad().pose.position,u=new(Function.prototype.bind.apply(n.Vector3,[null].concat(_toConsumableArray(l)))),c=new(Function.prototype.bind.apply(n.Vector3,[null].concat(_toConsumableArray(i)))),d=c.clone().sub(u).normalize(),h={L:u,R:c,scenePos:t.scene.position.clone(),sceneScale:t.scene.scale.clone(),offsetDir:d,quaternion:t.scene.quaternion.clone()};return e.Observable.combineLatest(s,o).map(function(e){return{start:h,current:{L:new(Function.prototype.bind.apply(n.Vector3,[null].concat(_toConsumableArray(e[1].position)))),R:new(Function.prototype.bind.apply(n.Vector3,[null].concat(_toConsumableArray(e[0].position))))}}}).takeUntil(a)}).subscribe(this.poseChange.bind(this))}},{key:"poseChange",value:function(e){var t=e.start,r=e.current,i=t.L.clone().add(t.R).divideScalar(2),o=r.L.clone().add(r.R).divideScalar(2),s=o.clone().sub(i).multiplyScalar(5);this.scene.position.copy(t.scenePos.clone().add(s));var a=t.L.distanceTo(t.R),l=r.L.distanceTo(r.R),u=t.sceneScale,c=l/a;this.scene.scale.set(u.x*c,u.y*c,u.z*c);var d=r.R.clone().sub(r.L).normalize(),h=new n.Quaternion;h.setFromUnitVectors(t.offsetDir,d),this.scene.quaternion.copy(h.multiply(t.quaternion))}},{key:"addFakeControllers",value:function(){var e=this,t=new n.BoxGeometry(.5,.5,.5),r=new n.MeshBasicMaterial({color:65280,wireframe:!1});this.lBox=new n.Mesh(t,r),this.cloudScene.add(this.lBox),this.vr.leftControllerPoseStream.map(function(t){var r=e.vr.controllers[1].standingMatrix,i=new(Function.prototype.bind.apply(n.Vector3,[null].concat(_toConsumableArray(t.position))));return e.cloudScene.worldToLocal(i.applyMatrix4(r))}).subscribe(function(t){e.lBox.position.copy(t);var n=1/e.cloudScene.scale.x/10;e.lBox.scale.set(n,n,n)}),this.rBox=new n.Mesh(t,r),this.cloudScene.add(this.rBox),this.vr.rightControllerPoseStream.map(function(t){var r=e.vr.controllers[0].standingMatrix,i=new(Function.prototype.bind.apply(n.Vector3,[null].concat(_toConsumableArray(t.position))));return e.cloudScene.worldToLocal(i.applyMatrix4(r))}).subscribe(function(t){e.rBox.position.copy(t);var n=1/e.cloudScene.scale.x/10;e.rBox.scale.set(n,n,n)})}}]),VRPoseControl}(),o=i;t["default"]=o;!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"VRPoseControl","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/three/vrPoseControl.js"),__REACT_HOT_LOADER__.register(o,"default","/Volumes/Storage/Development/kineviz/Demos/EEG_Skull/src/three/vrPoseControl.js"))}()}).call(t,n(192),n(25))},355:function(e,t,n){t=e.exports=n(152)(!1),t.push([e.i,"body,html{position:absolute;overflow:hidden}#kv-root,.app,body,html{width:100%;height:100%}#threeContainer{height:100%}",""])},770:function(e,t,n){var r=n(355);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(292)(r,i);r.locals&&(e.exports=r.locals)},782:function(e,t){e.exports="uniform vec3 color;\nuniform sampler2D texture;\nvarying vec3 vColor;\nvoid main() {\n\tgl_FragColor = vec4( color * vColor, 1.0 );\n\tgl_FragColor = gl_FragColor * texture2D( texture, gl_PointCoord );\n\t// gl_FragColor = texture2D( texture, gl_PointCoord );\n}\n"},783:function(e,t){e.exports="attribute float size;\nattribute vec3 customColor;\nvarying vec3 vColor;\nvoid main() {\n\tvColor = customColor;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_PointSize = size * ( 300.0 / -mvPosition.z );\n\tgl_Position = projectionMatrix * mvPosition;\n}\n"},785:function(e,t,n){e.exports=n(296)}},[785]);